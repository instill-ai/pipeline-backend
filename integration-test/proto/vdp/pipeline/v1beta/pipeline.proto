syntax = "proto3";

package vdp.pipeline.v1beta;

import "../../../common/healthcheck/v1beta/healthcheck.proto";
// Core definitions
import "../../../core/mgmt/v1beta/mgmt.proto";
// Google API
import "google/api/field_behavior.proto";
import "google/api/resource.proto";
// Protocol Buffers Well-Known Types
import "google/longrunning/operations.proto";
import "google/protobuf/field_mask.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";
// OpenAPI definition
import "protoc-gen-openapiv2/options/annotations.proto";
// VDP definitions
import "../../../vdp/pipeline/v1beta/common.proto";
import "../../../vdp/pipeline/v1beta/component_definition.proto";
import "../../../vdp/pipeline/v1beta/connector.proto";

// LivenessRequest represents a request to check a service liveness status
message LivenessRequest {
  // HealthCheckRequest message
  optional common.healthcheck.v1beta.HealthCheckRequest health_check_request = 1 [(google.api.field_behavior) = OPTIONAL];
}

// LivenessResponse represents a response for a service liveness status
message LivenessResponse {
  // HealthCheckResponse message
  common.healthcheck.v1beta.HealthCheckResponse health_check_response = 1;
}

// ReadinessRequest represents a request to check a service readiness status
message ReadinessRequest {
  // HealthCheckRequest message
  optional common.healthcheck.v1beta.HealthCheckRequest health_check_request = 1 [(google.api.field_behavior) = OPTIONAL];
}

// ReadinessResponse represents a response for a service readiness status
message ReadinessResponse {
  // HealthCheckResponse message
  common.healthcheck.v1beta.HealthCheckResponse health_check_response = 1;
}

// StartComponent
// Configures the starting point for pipeline triggering.
message StartComponent {
  // Represents a field within the start component.
  message Field {
    // Title of the field.
    string title = 1 [(google.api.field_behavior) = OPTIONAL];
    // Description of the field.
    string description = 2 [(google.api.field_behavior) = OPTIONAL];
    // Instill format.
    string instill_format = 3 [(google.api.field_behavior) = OPTIONAL];
    // Instill UI order.
    int32 instill_ui_order = 4 [(google.api.field_behavior) = OPTIONAL];
    // Instill UI Multiline.
    bool instill_ui_multiline = 5 [(google.api.field_behavior) = OPTIONAL];
  }
  // Fields configuration.
  // Key: Key of the input data.
  // Field: Field settings of the value.
  map<string, Field> fields = 1 [(google.api.field_behavior) = OPTIONAL];
}

// EndComponent
// Configures the ending point for pipeline triggering.
message EndComponent {
  // Represents a field within the end component.
  message Field {
    // Title of the field.
    string title = 1 [(google.api.field_behavior) = OPTIONAL];
    // Description of the field.
    string description = 2 [(google.api.field_behavior) = OPTIONAL];
    // Value of the field.
    string value = 3 [(google.api.field_behavior) = OPTIONAL];
    // Instill UI order.
    int32 instill_ui_order = 4 [(google.api.field_behavior) = OPTIONAL];
  }
  // Fields configuration.
  // Key: Key of the output data.
  // Field: Field settings of the value.
  map<string, Field> fields = 1 [(google.api.field_behavior) = OPTIONAL];
}

// ConnectorComponent
// Configures a connector component. Requires the creation of a connector resource first.
message ConnectorComponent {
  // Definition name.
  string definition_name = 1 [(google.api.field_behavior) = OPTIONAL];
  // Connector definition.
  ConnectorDefinition definition = 2 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Connector name. Leave empty if not created.
  string connector_name = 3 [(google.api.field_behavior) = OPTIONAL];
  // Describes the connector details (e.g., configuration to connect with the vendor service).
  Connector connector = 4 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Task.
  string task = 5 [(google.api.field_behavior) = OPTIONAL];
  // Input configuration of the component. JSON schema described in the connector definition.
  google.protobuf.Struct input = 6 [(google.api.field_behavior) = OPTIONAL];
  // Condition statement determining whether the component is executed or not.
  string condition = 7 [(google.api.field_behavior) = OPTIONAL];
}

// OperatorComponent
// Configures an operator component.
message OperatorComponent {
  // Definition name.
  string definition_name = 1 [(google.api.field_behavior) = OPTIONAL];
  // Operator definition.
  OperatorDefinition definition = 2 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Task.
  string task = 3 [(google.api.field_behavior) = OPTIONAL];
  // Input configuration of the component. JSON schema described in the operator definition.
  google.protobuf.Struct input = 4 [(google.api.field_behavior) = OPTIONAL];
  // Condition statement determining whether the component is executed or not.
  string condition = 5 [(google.api.field_behavior) = OPTIONAL];
}

// IteratorComponent
// Configures an iterator component. An iterator takes an array and executes an
// operation (defined by a set of nested components) on each of its elements.
// It can be regarded as triggering a sub-pipeline using the elements of an
// array as input.
message IteratorComponent {
  // Input: The iterator will iterate over the elements of the input (must be an array).
  string input = 1 [(google.api.field_behavior) = OPTIONAL];

  // Output elements: Configure the output arrays of the iterator.
  // The key is the output element variable name, and the value is the data reference of the template.
  // Example:
  // output_elements: {
  //   "key1": "${element.output.a}",
  //   "key2": "${element.output.b}",
  // }
  // This will create the results:
  // output: {
  //   "key1": [ ${element1.output.a},  ${element2.output.a} ... ],
  //   "key2": [ ${element1.output.b},  ${element2.output.b} ... ],
  // }
  map<string, string> output_elements = 2 [(google.api.field_behavior) = OPTIONAL];

  // Components: These components will be executed for each input element.
  repeated NestedComponent components = 3 [(google.api.field_behavior) = OPTIONAL];

  // Condition statement determining whether the component is executed or not.
  string condition = 4 [(google.api.field_behavior) = OPTIONAL];

  // DataSpecification returns the JSON schema for the iterator input and output.
  DataSpecification data_specification = 5 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// Component
// Fundamental building block in pipelines.
//
// For more information, see [Pipeline
// Component](https://www.instill.tech/docs/latest/core/concepts/pipeline#pipeline-component)
message Component {
  // Component ID, provided by the user on creation.
  string id = 1 [(google.api.field_behavior) = REQUIRED];
  // Deleted fields
  reserved 2 to 9;
  // Metadata of the component.
  google.protobuf.Struct metadata = 10 [(google.api.field_behavior) = OPTIONAL];
  // The component configuration.
  oneof component {
    // StartComponent
    StartComponent start_component = 11;
    // EndComponent
    EndComponent end_component = 12;
    // ConnectorComponent
    ConnectorComponent connector_component = 13;
    // OperatorComponent
    OperatorComponent operator_component = 14;
    // IteratorComponent
    IteratorComponent iterator_component = 15;
  }
}

// NestedComponent
// Fundamental building block in iterator component.
message NestedComponent {
  // Component ID, provided by the user on creation.
  string id = 1 [(google.api.field_behavior) = REQUIRED];
  // Metadata of the component.
  google.protobuf.Struct metadata = 2 [(google.api.field_behavior) = OPTIONAL];
  // The component configuration.
  oneof component {
    // ConnectorConfiguration
    ConnectorComponent connector_component = 3;
    // OperatorConfiguration
    OperatorComponent operator_component = 4;
  }
}

// Recipe describes the components of a Pipeline and how they are connected.
message Recipe {
  // Recipe schema version.
  string version = 1;
  // List of pipeline components.
  repeated Component components = 2;
}

// State describes the state of a pipeline.
enum State {
  // Unspecified.
  STATE_UNSPECIFIED = 0;
  // Inactive.
  STATE_INACTIVE = 1;
  // Active.
  STATE_ACTIVE = 2;
  // The pipeline has an error.
  STATE_ERROR = 3;
}

// A Pipeline is an end-to-end workflow that automates a sequence of components
// to process data.
//
// For more information, see
// [Pipeline](https://www.instill.tech/docs/latest/core/concepts/pipeline) in
// the official documentation.
message Pipeline {
  option (google.api.resource) = {
    type: "api.instill.tech/Pipeline"
    pattern: "users/{user.id}/pipelines/{pipeline.id}"
    pattern: "pipelines/{pipeline.uid}"
  };

  // View defines how a Pipeline is presented.
  enum View {
    // Unspecified, equivalent to BASIC.
    VIEW_UNSPECIFIED = 0;
    // Default view, only includes basic information.
    VIEW_BASIC = 1;
    // Full representation.
    VIEW_FULL = 2;
    // Contains the recipe of the resource.
    VIEW_RECIPE = 3;
  }

  // Visibility defines who can access the pipeline.
  enum Visibility {
    // Unspecified, equivalent to PRIVATE.
    VISIBILITY_UNSPECIFIED = 0;
    // Only the user can see the pipeline.
    VISIBILITY_PRIVATE = 1;
    // Other users can see the pipeline.
    VISIBILITY_PUBLIC = 2;
  }

  // The name of the pipeline, defined by its parent and ID.
  // - Format: `{parent_type}/{parent.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = OUTPUT_ONLY,
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "pipeline_name"}
    }
  ];

  // Pipeline UUID.
  string uid = 2 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Pipeline resource ID (used in `name` as the last segment). This conforms
  // to RFC-1034, which restricts to letters, numbers, and hyphen, with the
  // first character a letter, the last a letter or a number, and a 63
  // character maximum.
  string id = 3 [(google.api.field_behavior) = IMMUTABLE];
  // Pipeline description.
  optional string description = 4 [(google.api.field_behavior) = OPTIONAL];
  // Recipe describes the components of a Pipeline and how they are connected.
  Recipe recipe = 5 [(google.api.field_behavior) = IMMUTABLE];
  // Pipeline creation time.
  google.protobuf.Timestamp create_time = 10 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Pipeline update time.
  google.protobuf.Timestamp update_time = 11 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Deleted field.
  reserved 13;
  // Pipeline delete time.
  google.protobuf.Timestamp delete_time = 14 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Pipeline sharing information.
  Sharing sharing = 15;
  // Metadata holds console-related data such as the pipeline builder layout.
  google.protobuf.Struct metadata = 16;
  // Owner Name.
  string owner_name = 17 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Deleted Fields.
  reserved 18;
  // Releases holds the history of pipeline versions.
  repeated PipelineRelease releases = 19 [(google.api.field_behavior) = OUTPUT_ONLY];
  // README holds the pipeline documentation.
  string readme = 20 [(google.api.field_behavior) = OPTIONAL];
  // Permission defines how a pipeline can be used.
  Permission permission = 21 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Pipeline visibility.
  Visibility visibility = 22 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Pipeline owner.
  optional core.mgmt.v1beta.Owner owner = 23 [
    (google.api.field_behavior) = OPTIONAL,
    (google.api.field_behavior) = OUTPUT_ONLY
  ];
  // Data specifications.
  DataSpecification data_specification = 24 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// TriggerMetadata contains the traces of the pipeline inference.
message TriggerMetadata {
  // Each key in the `traces` object is a component ID. The value is a Trace
  // object containing the execution details.
  map<string, Trace> traces = 1;
}

// Trace contains the execution details of a component.
message Trace {
  // Status holds the the component execution outcome.
  enum Status {
    // Unspecified.
    STATUS_UNSPECIFIED = 0;
    // Successfully completed.
    STATUS_COMPLETED = 1;
    // Skipped.
    STATUS_SKIPPED = 2;
    // Aborted with error.
    STATUS_ERROR = 3;
  }
  // Statuses contains an execution status per input.
  repeated Status statuses = 1;
  // Component inputs.
  repeated google.protobuf.Struct inputs = 2;
  // Component outputs.
  repeated google.protobuf.Struct outputs = 3;
  // Error details.
  google.protobuf.Struct error = 4;
  // Computation time in seconds.
  float compute_time_in_seconds = 5;
}

// Pipeline releases contain the version control information of a pipeline.
// This allows users to track changes in the pipeline over time.
message PipelineRelease {
  option (google.api.resource) = {
    type: "api.instill.tech/Release"
    pattern: "users/{user.id}/pipelines/{pipeline.id}/releases/{release.id}"
  };

  // The name of the release, defined by its parent and ID.
  // - Format: `{parent_type}/{parent.id}/pipelines/{pipeline.id}/releases/{release.id}
  string name = 1 [
    (google.api.field_behavior) = OUTPUT_ONLY,
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "pipeline_release_name"}
    }
  ];
  // Release UUID.
  string uid = 2 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Release resource ID (used in `name` as the last segment). It must be a
  // sematic version vX.Y.Z.
  string id = 3 [(google.api.field_behavior) = IMMUTABLE];
  // Release description.
  optional string description = 4 [(google.api.field_behavior) = OPTIONAL];
  // Recipe of the versioned pipeline.
  Recipe recipe = 5 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Pipeline creation time.
  google.protobuf.Timestamp create_time = 6 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Pipeline update time.
  google.protobuf.Timestamp update_time = 7 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Deleted field.
  reserved 9;
  // Pipeline deletion time.
  google.protobuf.Timestamp delete_time = 10 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Alias.
  string alias = 11 [(google.api.field_behavior) = OUTPUT_ONLY];
  // Key-value object with console-related data such as the pipeline builder
  // layout.
  google.protobuf.Struct metadata = 12;
  // README.
  string readme = 13 [(google.api.field_behavior) = OPTIONAL];
  // Data specifications.
  DataSpecification data_specification = 14 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// ListPipelinesRequest represents a request to list pipelines.
message ListPipelinesRequest {
  // The maximum number of pipelines to return. If this parameter is
  // unspecified, at most 10 pipelines will be returned. The cap value for this
  // parameter is 100 (i.e. any value above that will be coerced to 100).
  optional int32 page_size = 1 [(google.api.field_behavior) = OPTIONAL];
  // Page token.
  optional string page_token = 2 [(google.api.field_behavior) = OPTIONAL];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 3 [(google.api.field_behavior) = OPTIONAL];
  // Filter can hold an [AIP-160](https://google.aip.dev/160)-compliant filter
  // expression.
  // - Example: `create_time>timestamp("2000-06-19T23:31:08.657Z")`.
  // - Example:
  // `recipe.components.definition_name:"operator-definitions/2ac8be70-0f7a-4b61-a33d-098b8acfa6f3"`.
  optional string filter = 4 [(google.api.field_behavior) = OPTIONAL];
  // Include soft-deleted pipelines in the result.
  optional bool show_deleted = 5 [(google.api.field_behavior) = OPTIONAL];
  // Limit results to pipelines with the specified visibility.
  optional Pipeline.Visibility visibility = 6 [(google.api.field_behavior) = OPTIONAL];
}

// ListPipelinesResponse contains a list of pipelines.
message ListPipelinesResponse {
  // A list of pipeline resources.
  repeated Pipeline pipelines = 1;
  // Next page token.
  string next_page_token = 2;
  // Total number of pipelines.
  int32 total_size = 3;
}

// LookUpPipelineRequest represents a request to query a pipeline by its UID.
message LookUpPipelineRequest {
  // The permalink of the pipeline, which allows its access by UID.
  // - Format: `pipelines/{pipeline.uid}`.
  string permalink = 1 [(google.api.field_behavior) = REQUIRED];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 2 [(google.api.field_behavior) = OPTIONAL];
}

// LookUpPipelineResponse contains the requested pipeline.
message LookUpPipelineResponse {
  // The requested pipeline.
  Pipeline pipeline = 1;
}

// CreateUserPipelineRequest represents a request from a user to create a
// pipeline.
message CreateUserPipelineRequest {
  // The properties of the pipeline to be created.
  Pipeline pipeline = 1;
  // The parent resource, i.e., the user that creates the pipeline.
  // - Format: `users/{user.id}`.
  string parent = 2 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {child_type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_name"}
    }
  ];
}

// CreateUserPipelineResponse contains the created pipeline.
message CreateUserPipelineResponse {
  // The created pipeline resource.
  Pipeline pipeline = 1;
}

// ListUserPipelinesRequest represents a request to list the pipelines of a
// user.
message ListUserPipelinesRequest {
  // The maximum number of pipelines to return. If this parameter is
  // unspecified, at most 10 pipelines will be returned. The cap value for this
  // parameter is 100 (i.e. any value above that will be coerced to 100).
  optional int32 page_size = 1 [(google.api.field_behavior) = OPTIONAL];
  // Page token.
  optional string page_token = 2 [(google.api.field_behavior) = OPTIONAL];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 3 [(google.api.field_behavior) = OPTIONAL];
  // Filter can hold an [AIP-160](https://google.aip.dev/160)-compliant filter
  // expression.
  // - Example: `create_time>timestamp("2000-06-19T23:31:08.657Z")`.
  // - Example:
  // `recipe.components.definition_name:"operator-definitions/2ac8be70-0f7a-4b61-a33d-098b8acfa6f3"`.
  optional string filter = 4 [(google.api.field_behavior) = OPTIONAL];
  // The parent resource, i.e., the user that created the pipelines.
  // - Format: `users/{user.id}`.
  string parent = 5 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {child_type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_name"}
    }
  ];
  // Include soft-deleted pipelines in the result.
  optional bool show_deleted = 6 [(google.api.field_behavior) = OPTIONAL];
  // Limit results to pipelines with the specified visibility.
  optional Pipeline.Visibility visibility = 7 [(google.api.field_behavior) = OPTIONAL];
}

// ListUserPipelinesResponse contains a list of pipelines.
message ListUserPipelinesResponse {
  // A list of pipeline resources.
  repeated Pipeline pipelines = 1;
  // Next page token.
  string next_page_token = 2;
  // Total number of pipelines.
  int32 total_size = 3;
}

// GetUserPipelineRequest represents a request to fetch the details of a
// pipeline owned by a user.
message GetUserPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent user
  // and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_name"}
    }
  ];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 2 [(google.api.field_behavior) = OPTIONAL];
}

// GetUserPipelineResponse contains the requested pipeline.
message GetUserPipelineResponse {
  // The pipeline resource.
  Pipeline pipeline = 1;
}

// UpdateUserPipelineRequest represents a request to update a pipeline owned by
// a user.
message UpdateUserPipelineRequest {
  // The pipeline fields that will replace the existing ones.
  Pipeline pipeline = 1 [(google.api.field_behavior) = REQUIRED];
  // The update mask specifies the subset of fields that should be modified.
  //
  // For more information about this field, see
  // https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#field-mask.
  google.protobuf.FieldMask update_mask = 2 [(google.api.field_behavior) = REQUIRED];
}

// UpdateUserPipelineResponse contains the updated pipeline.
message UpdateUserPipelineResponse {
  // The updated pipeline resource.
  Pipeline pipeline = 1;
}

// DeleteUserPipelineRequest represents a request to delete a pipeline owned by
// a user.
message DeleteUserPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent user
  // and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_name"}
    }
  ];
}

// DeleteUserPipelineResponse is an empty response.
message DeleteUserPipelineResponse {}

// ValidateUserPipelineRequest represents a request to validate a pipeline
// owned by a user.
message ValidateUserPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent user
  // and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_name"}
    }
  ];
}

// ValidateUserPipelineResponse contains a validated pipeline.
message ValidateUserPipelineResponse {
  // The validated pipeline resource.
  Pipeline pipeline = 1;
}

// RenameUserPipelineRequest represents a request to rename the name of a
// pipeline owned by a user.
message RenameUserPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent user
  // and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_name"}
    }
  ];
  // The new resource ID. This will transform the resource name into
  // `users/{user.id}/pipelines/{new_pipeline_id}`.
  string new_pipeline_id = 2 [(google.api.field_behavior) = REQUIRED];
}

// RenameUserPipelineResponse contains a renamed pipeline.
message RenameUserPipelineResponse {
  // The renamed pipeline resource.
  Pipeline pipeline = 1;
}

// CloneUserPipelineRequest represents a request to clone a pipeline owned by a
// user.
message CloneUserPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent user
  // and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_name"}
    }
  ];
  // The target pipeline name. It can be under a user or an organization
  // namespace, so the following formats are accepted:
  // - `users/{user.id}/pipelines/{pipeline.id}`
  // - `organizations/{organization.id}/pipelines/{pipeline.id}`
  string target = 2 [(google.api.field_behavior) = REQUIRED];
}

// CloneUserPipelineResponse contains a cloned pipeline.
message CloneUserPipelineResponse {
  // The cloned pipeline resource.
  Pipeline pipeline = 1;
}

// TriggerUserPipelineRequest represents a request to trigger a user-owned
// pipeline synchronously.
message TriggerUserPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent user
  // and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_name"}
    }
  ];
  // Pipeline input parameters.
  repeated google.protobuf.Struct inputs = 2 [(google.api.field_behavior) = REQUIRED];
}

// TriggerUserPipelineResponse contains the pipeline execution results, i.e.,
// the multiple model inference outputs.
message TriggerUserPipelineResponse {
  // Model inference outputs.
  repeated google.protobuf.Struct outputs = 1;
  // Traces of the pipeline inference.
  TriggerMetadata metadata = 2;
}

// TriggerUserPipelineRequest represents a request to trigger a user-owned
// pipeline synchronously.
message TriggerAsyncUserPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent user
  // and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_name"}
    }
  ];
  // Pipeline input parameters.
  repeated google.protobuf.Struct inputs = 2 [(google.api.field_behavior) = REQUIRED];
}

// TriggerAsyncUserPipelineResponse contains the information to access the
// status of an asynchronous pipeline execution.
message TriggerAsyncUserPipelineResponse {
  // Long-running operation information.
  google.longrunning.Operation operation = 1 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// CreateUserPipelineReleaseRequest represents a request to release a version
// in a user-owned pipeline.
message CreateUserPipelineReleaseRequest {
  // The release information.
  PipelineRelease release = 1;
  // Name of the pipeline for which the release will be created.
  // Format: `users/{user.id}/pipelines/{pipeline.id}`
  string parent = 2 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {child_type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_name"}
    }
  ];
}

// CreateUserPipelineReleaseResponse contains the created release.
message CreateUserPipelineReleaseResponse {
  // The created pipeline release object.
  PipelineRelease release = 1;
}

// ListUserPipelineReleasesRequest represents a request to list the releases in
// a user-owned pipeline.
message ListUserPipelineReleasesRequest {
  // The maximum number of releases to return. If this parameter is
  // unspecified, at most 10 pipelines will be returned. The cap value for this
  // parameter is 100 (i.e. any value above that will be coerced to 100).
  optional int32 page_size = 1 [(google.api.field_behavior) = OPTIONAL];
  // Page token.
  optional string page_token = 2 [(google.api.field_behavior) = OPTIONAL];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 3 [(google.api.field_behavior) = OPTIONAL];
  // Filter can hold an [AIP-160](https://google.aip.dev/160)-compliant filter
  // expression.
  // - Example: `create_time>timestamp("2000-06-19T23:31:08.657Z")`.
  optional string filter = 4 [(google.api.field_behavior) = OPTIONAL];
  // The parent resource where this pipeline release will be created.
  // Format: `users/{user.id}/pipelines/{pipeline.id}`.
  string parent = 5 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {child_type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_name"}
    }
  ];
  // Include soft-deleted pipelines in the result.
  optional bool show_deleted = 6 [(google.api.field_behavior) = OPTIONAL];
}

// ListUserPipelineReleasesResponse contains a list of pipeline releases.
message ListUserPipelineReleasesResponse {
  // A list of pipeline release resources.
  repeated PipelineRelease releases = 1;
  // Next page token.
  string next_page_token = 2;
  // Total number of pipeline releases.
  int32 total_size = 3;
}

// GetUserPipelineReleaseRequest represents a request to fetchthe details of a
// release in a user-owned pipeline.
message GetUserPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_release_name"}
    }
  ];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 2 [(google.api.field_behavior) = OPTIONAL];
}

// GetUserPipelineReleaseResponse contains the requested pipeline release.
message GetUserPipelineReleaseResponse {
  // The pipeline release resource.
  PipelineRelease release = 1;
}

// UpdateUserPipelineReleaseRequest represents a request to update a user-owned
// pipeline release.
message UpdateUserPipelineReleaseRequest {
  // The pipeline release fields that will replace the existing ones.
  // A pipeline release resource to update
  PipelineRelease release = 1 [(google.api.field_behavior) = REQUIRED];
  // The update mask specifies the subset of fields that should be modified.
  //
  // For more information about this field, see
  // https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#field-mask.
  google.protobuf.FieldMask update_mask = 2 [(google.api.field_behavior) = REQUIRED];
}

// UpdateUserPipelineReleaseResponse contains the updated pipeline release.
message UpdateUserPipelineReleaseResponse {
  // The updated pipeline release resource.
  PipelineRelease release = 1;
}

// DeleteUserPipelineReleaseRequest represents a request to delete a release in
// a user-owned pipeline.
message DeleteUserPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_release_name"}
    }
  ];
}

// DeleteUserPipelineReleaseResponse is an empty response.
message DeleteUserPipelineReleaseResponse {}

// RestoreUserPipelineReleaseRequest represents a request to set the version of
// a user-owned pipeline to a pinned release.
message RestoreUserPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_release_name"}
    }
  ];
}

// RestoreUserPipelineReleaseResponse contains the requested pipeline release.
message RestoreUserPipelineReleaseResponse {
  // The pipeline release resource.
  PipelineRelease release = 1;
}

// RenameUserPipelineReleaseRequest represents a request to rename a release in
// a user-owned pipeline.
message RenameUserPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_release_name"}
    }
  ];
  // The new resource ID. This will transform the resource name into
  // `users/{user.id}/pipelines/{pipeline.id}/releases{new_release_id}`.
  string new_pipeline_release_id = 2 [(google.api.field_behavior) = REQUIRED];
}

// RenameUserPipelineReleaseResponse contains a renamed pipeline release.
message RenameUserPipelineReleaseResponse {
  // The renamed pipeline release.
  PipelineRelease release = 1;
}

// WatchUserPipelineReleaseRequest represents a request to query the state of a
// user-owned pipeline release.
message WatchUserPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_release_name"}
    }
  ];
}

// WatchUserPipelineReleaseResponse contains the pipeline release current
// state.
message WatchUserPipelineReleaseResponse {
  // The pipeline release state.
  State state = 1;
}

// TriggerUserPipelineReleaseRequest represents a request to trigger a pinned
// release of a user-owned pipeline.
message TriggerUserPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_release_name"}
    }
  ];
  // Pipeline input parameters.
  repeated google.protobuf.Struct inputs = 2 [(google.api.field_behavior) = REQUIRED];
}

// TriggerUserPipelineReleaseResponse contains the pipeline execution results,
// i.e., the multiple model inference outputs.
message TriggerUserPipelineReleaseResponse {
  // Model inference outputs.
  repeated google.protobuf.Struct outputs = 1;
  // Traces of the pipeline inference.
  TriggerMetadata metadata = 2;
}

// TriggerUserPipelineReleaseRequest represents a request to trigger a pinned
// release of a user-owned pipeline asynchronously.
message TriggerAsyncUserPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format: `users/{user.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_release_name"}
    }
  ];
  // Pipeline input parameters.
  repeated google.protobuf.Struct inputs = 2 [(google.api.field_behavior) = REQUIRED];
}

// TriggerAsyncUserPipelineReleaseResponse contains the information to access
// the status of an asynchronous pipeline execution.
message TriggerAsyncUserPipelineReleaseResponse {
  // Long-running operation information.
  google.longrunning.Operation operation = 1 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// CreateOrganizationPipelineRequest represents a request from an organization
// to create a pipeline.
message CreateOrganizationPipelineRequest {
  // The properties of the pipeline to be created.
  Pipeline pipeline = 1;
  // The parent resource, i.e., the organization that creates the pipeline.
  // - Format: `organizations/{organization.id}`.
  string parent = 2 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {child_type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_name"}
    }
  ];
}

// CreateOrganizationPipelineResponse contains the created pipeline.
message CreateOrganizationPipelineResponse {
  // The created pipeline resource.
  Pipeline pipeline = 1;
}

// ListOrganizationPipelinesRequest represents a request to list the pipelines
// of an organization.
message ListOrganizationPipelinesRequest {
  // The maximum number of pipelines to return. If this parameter is
  // unspecified, at most 10 pipelines will be returned. The cap value for this
  // parameter is 100 (i.e. any value above that will be coerced to 100).
  optional int32 page_size = 1 [(google.api.field_behavior) = OPTIONAL];
  // Page token.
  optional string page_token = 2 [(google.api.field_behavior) = OPTIONAL];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 3 [(google.api.field_behavior) = OPTIONAL];
  // Filter can hold an [AIP-160](https://google.aip.dev/160)-compliant filter
  // expression.
  // - Example: `create_time>timestamp("2000-06-19T23:31:08.657Z")`.
  // - Example:
  // `recipe.components.definition_name:"operator-definitions/2ac8be70-0f7a-4b61-a33d-098b8acfa6f3"`.
  optional string filter = 4 [(google.api.field_behavior) = OPTIONAL];
  // The parent resource, i.e., the organization that created the pipelines.
  // - Format: `organizations/{organization.id}`.
  string parent = 5 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {child_type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_name"}
    }
  ];
  // Include soft-deleted pipelines in the result.
  optional bool show_deleted = 6 [(google.api.field_behavior) = OPTIONAL];
  // Limit results to pipelines with the specified visibility.
  optional Pipeline.Visibility visibility = 7 [(google.api.field_behavior) = OPTIONAL];
}

// ListOrganizationPipelinesResponse contains a list of pipelines.
message ListOrganizationPipelinesResponse {
  // A list of pipeline resources.
  repeated Pipeline pipelines = 1;
  // Next page token.
  string next_page_token = 2;
  // Total number of pipelines.
  int32 total_size = 3;
}

// GetOrganizationPipelineRequest represents a request to fetch the details of
// a pipeline owned by an organization.
message GetOrganizationPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent
  // organization and ID.
  // - Format: `organizations/{organization.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_name"}
    }
  ];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 2 [(google.api.field_behavior) = OPTIONAL];
}

// GetOrganizationPipelineResponse contains the requested pipeline.
message GetOrganizationPipelineResponse {
  // The pipeline resource.
  Pipeline pipeline = 1;
}

// UpdateOrganizationPipelineRequest represents a request to update a pipeline
// owned by an organization.
message UpdateOrganizationPipelineRequest {
  // The pipeline fields that will replace the existing ones.
  Pipeline pipeline = 1 [(google.api.field_behavior) = REQUIRED];
  // The update mask specifies the subset of fields that should be modified.
  //
  // For more information about this field, see
  // https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#field-mask.
  google.protobuf.FieldMask update_mask = 2 [(google.api.field_behavior) = REQUIRED];
}

// UpdateOrganizationPipelineResponse contains the updated pipeline.
message UpdateOrganizationPipelineResponse {
  // The updated pipeline resource.
  Pipeline pipeline = 1;
}

// DeleteOrganizationPipelineRequest represents a request to delete a pipeline
// owned by an organization.
message DeleteOrganizationPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent
  // organization and ID.
  // - Format: `organizations/{organization.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_name"}
    }
  ];
}

// DeleteOrganizationPipelineResponse is an empty response.
message DeleteOrganizationPipelineResponse {}

// ValidateOrganizationPipelineRequest represents a request to validate a
// pipeline owned by an organization.
message ValidateOrganizationPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent
  // organization and ID.
  // - Format: `organizations/{organization.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_name"}
    }
  ];
}

// ValidateOrganizationPipelineResponse contains a validated pipeline.
message ValidateOrganizationPipelineResponse {
  // The validated pipeline resource.
  Pipeline pipeline = 1;
}

// RenameOrganizationPipelineRequest represents a request to rename the name of
// a pipeline owned by an organization.
message RenameOrganizationPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent
  // organization and ID.
  // - Format: `organizations/{organization.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_name"}
    }
  ];
  // The new resource ID. This will transform the resource name into
  // `organizations/{organization.id}/pipelines/{new_pipeline_id}`.
  string new_pipeline_id = 2 [(google.api.field_behavior) = REQUIRED];
}

// RenameOrganizationPipelineResponse contains a renamed pipeline.
message RenameOrganizationPipelineResponse {
  // The renamed pipeline resource.
  Pipeline pipeline = 1;
}

// CloneOrganizationPipelineRequest represents a request to clone a pipeline
// owned by an organization.
message CloneOrganizationPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent
  // organization and ID.
  // - Format: `organizations/{organization.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "user_pipeline_name"}
    }
  ];
  // The target pipeline name. It can be under a user or an organization
  // namespace, so the following formats are accepted:
  // - `users/{user.id}/pipelines/{pipeline.id}`
  // - `organizations/{organization.id}/pipelines/{pipeline.id}`
  string target = 2 [(google.api.field_behavior) = REQUIRED];
}

// CloneOrganizationPipelineResponse contains a cloned pipeline.
message CloneOrganizationPipelineResponse {
  // The cloned pipeline resource.
  Pipeline pipeline = 1;
}

// TriggerOrganizationPipelineRequest represents a request to trigger an
// organization-owned pipeline synchronously.
message TriggerOrganizationPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent
  // organization and ID.
  // - Format: `organizations/{organization.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_name"}
    }
  ];
  // Pipeline input parameters.
  repeated google.protobuf.Struct inputs = 2 [(google.api.field_behavior) = REQUIRED];
}

// TriggerOrganizationPipelineResponse contains the pipeline execution results,
// i.e., the multiple model inference outputs.
message TriggerOrganizationPipelineResponse {
  // Model inference outputs.
  repeated google.protobuf.Struct outputs = 1;
  // Traces of the pipeline inference.
  TriggerMetadata metadata = 2;
}

// TriggerOrganizationPipelineRequest represents a request to trigger an
// organization-owned pipeline synchronously.
message TriggerAsyncOrganizationPipelineRequest {
  // The resource name of the pipeline, which allows its access by parent
  // organization and ID.
  // - Format: `organizations/{organization.id}/pipelines/{pipeline.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_name"}
    }
  ];
  // Pipeline input parameters.
  repeated google.protobuf.Struct inputs = 2 [(google.api.field_behavior) = REQUIRED];
}

// TriggerAsyncOrganizationPipelineResponse contains the information to access
// the status of an asynchronous pipeline execution.
message TriggerAsyncOrganizationPipelineResponse {
  // Long-running operation information.
  google.longrunning.Operation operation = 1 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// CreateOrganizationPipelineReleaseRequest represents a request to release a
// version in an organization-owned pipeline.
message CreateOrganizationPipelineReleaseRequest {
  // The release information.
  PipelineRelease release = 1;
  // Name of the pipeline for which the release will be created.
  // Format: `organizations/{organization.id}/pipelines/{pipeline.id}`
  string parent = 2 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {child_type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_name"}
    }
  ];
}

// CreateOrganizationPipelineReleaseResponse contains the created release.
message CreateOrganizationPipelineReleaseResponse {
  // The created pipeline release object.
  PipelineRelease release = 1;
}

// ListOrganizationPipelineReleasesRequest represents a request to list the
// releases in an organization-owned pipeline.
message ListOrganizationPipelineReleasesRequest {
  // The maximum number of releases to return. If this parameter is
  // unspecified, at most 10 pipelines will be returned. The cap value for this
  // parameter is 100 (i.e. any value above that will be coerced to 100).
  optional int32 page_size = 1 [(google.api.field_behavior) = OPTIONAL];
  // Page token.
  optional string page_token = 2 [(google.api.field_behavior) = OPTIONAL];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 3 [(google.api.field_behavior) = OPTIONAL];
  // Filter can hold an [AIP-160](https://google.aip.dev/160)-compliant filter
  // expression.
  // - Example: `create_time>timestamp("2000-06-19T23:31:08.657Z")`.
  optional string filter = 4 [(google.api.field_behavior) = OPTIONAL];
  // The parent resource where this pipeline release will be created.
  // Format: `organizations/{organization.id}/pipelines/{pipeline.id}`
  string parent = 5 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {child_type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_name"}
    }
  ];
  // Include soft-deleted pipelines in the result.
  optional bool show_deleted = 6 [(google.api.field_behavior) = OPTIONAL];
}

// ListOrganizationPipelineReleasesResponse contains a list of pipeline releases.
message ListOrganizationPipelineReleasesResponse {
  // A list of pipeline release resources.
  repeated PipelineRelease releases = 1;
  // Next page token.
  string next_page_token = 2;
  // Total number of pipeline releases.
  int32 total_size = 3;
}

// GetOrganizationPipelineReleaseRequest represents a request to fetchthe
// details of a release in an organization-owned pipeline.
message GetOrganizationPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format:
  // `organizations/{organization.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_release_name"}
    }
  ];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 2 [(google.api.field_behavior) = OPTIONAL];
}

// GetOrganizationPipelineReleaseResponse contains the requested pipeline release.
message GetOrganizationPipelineReleaseResponse {
  // The pipeline release resource.
  PipelineRelease release = 1;
}

// UpdateOrganizationPipelineReleaseRequest represents a request to update an
// organization-owned pipeline release.
message UpdateOrganizationPipelineReleaseRequest {
  // The pipeline release fields that will replace the existing ones.
  // A pipeline release resource to update
  PipelineRelease release = 1 [(google.api.field_behavior) = REQUIRED];
  // The update mask specifies the subset of fields that should be modified.
  //
  // For more information about this field, see
  // https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#field-mask.
  google.protobuf.FieldMask update_mask = 2 [(google.api.field_behavior) = REQUIRED];
}

// UpdateOrganizationPipelineReleaseResponse contains the updated pipeline
// release.
message UpdateOrganizationPipelineReleaseResponse {
  // The updated pipeline release resource.
  PipelineRelease release = 1;
}

// DeleteOrganizationPipelineReleaseRequest represents a request to delete a
// release in an organization-owned pipeline.
message DeleteOrganizationPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format:
  // `organizations/{organization.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_release_name"}
    }
  ];
}

// DeleteOrganizationPipelineReleaseResponse is an empty response.
message DeleteOrganizationPipelineReleaseResponse {}

// RestoreOrganizationPipelineReleaseRequest represents a request to set the
// version of an organization-owned pipeline to a pinned release.
message RestoreOrganizationPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format:
  // `organizations/{organization.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_release_name"}
    }
  ];
}

// RestoreOrganizationPipelineReleaseResponse contains the requested pipeline
// release.
message RestoreOrganizationPipelineReleaseResponse {
  // The pipeline release resource.
  PipelineRelease release = 1;
}

// RenameOrganizationPipelineReleaseRequest represents a request to rename a
// release in an organization-owned pipeline.
message RenameOrganizationPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format:
  // `organizations/{organization.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_release_name"}
    }
  ];
  // The new resource ID. This will transform the resource name into
  // `organizations/{organization.id}/pipelines/{pipeline.id}/releases{new_release_id}`.
  string new_pipeline_release_id = 2 [(google.api.field_behavior) = REQUIRED];
}

// RenameOrganizationPipelineReleaseResponse contains a renamed pipeline release.
message RenameOrganizationPipelineReleaseResponse {
  // The renamed pipeline release.
  PipelineRelease release = 1;
}

// WatchOrganizationPipelineReleaseRequest represents a request to query the
// state of an organization-owned pipeline release.
message WatchOrganizationPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format:
  // `organizations/{organization.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_release_name"}
    }
  ];
}

// WatchOrganizationPipelineReleaseResponse contains the pipeline release
// current state.
message WatchOrganizationPipelineReleaseResponse {
  // The pipeline release state.
  State state = 1;
}

// TriggerOrganizationPipelineReleaseRequest represents a request to trigger a
// pinned release of an organization-owned pipeline.
message TriggerOrganizationPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format:
  // `organizations/{organization.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_release_name"}
    }
  ];
  // Pipeline input parameters.
  repeated google.protobuf.Struct inputs = 2 [(google.api.field_behavior) = REQUIRED];
}

// TriggerOrganizationPipelineReleaseResponse contains the pipeline execution
// results, i.e., the multiple model inference outputs.
message TriggerOrganizationPipelineReleaseResponse {
  // Model inference outputs.
  repeated google.protobuf.Struct outputs = 1;
  // Traces of the pipeline inference.
  TriggerMetadata metadata = 2;
}

// TriggerOrganizationPipelineReleaseRequest represents a request to trigger a
// pinned release of an organization-owned pipeline asynchronously.
message TriggerAsyncOrganizationPipelineReleaseRequest {
  // The resource name of the pipeline release, which allows its access by
  // parent pipeline and ID.
  // - Format:
  // `organizations/{organization.id}/pipelines/{pipeline.id}/releases/{release.id}`.
  string name = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/PipelineRelease"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "organization_pipeline_release_name"}
    }
  ];
  // Pipeline input parameters.
  repeated google.protobuf.Struct inputs = 2 [(google.api.field_behavior) = REQUIRED];
}

// TriggerAsyncOrganizationPipelineReleaseResponse contains the information to
// access the status of an asynchronous pipeline execution.
message TriggerAsyncOrganizationPipelineReleaseResponse {
  // Long-running operation information.
  google.longrunning.Operation operation = 1 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// GetOperationRequest represents a request to query a long-running operation.
message GetOperationRequest {
  // The name of the operation resource. Asynchronous methods will contain this
  // information in their response.
  string name = 1 [(google.api.field_behavior) = REQUIRED];
}

// GetOperationResponse contains the long-running operation details.
message GetOperationResponse {
  // The long-running operation.
  google.longrunning.Operation operation = 1 [(google.api.field_behavior) = OUTPUT_ONLY];
}

// ========== Private endpoints

// ListPipelinesAdminRequest represents a request by an admin to list all the
// pipelines. Admin users have access to pipelines from any user.
message ListPipelinesAdminRequest {
  // The maximum number of pipelines to return. If this parameter is
  // unspecified, at most 10 pipelines will be returned. The cap value for this
  // parameter is 100 (i.e. any value above that will be coerced to 100).
  optional int32 page_size = 1 [(google.api.field_behavior) = OPTIONAL];
  // Page token.
  optional string page_token = 2 [(google.api.field_behavior) = OPTIONAL];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 3 [(google.api.field_behavior) = OPTIONAL];
  // Filter can hold an [AIP-160](https://google.aip.dev/160)-compliant filter
  // expression.
  // - Example: `create_time>timestamp("2000-06-19T23:31:08.657Z")`.
  // - Example:
  // `recipe.components.definition_name:"operator-definitions/2ac8be70-0f7a-4b61-a33d-098b8acfa6f3"`.
  optional string filter = 4 [(google.api.field_behavior) = OPTIONAL];
  // Include soft-deleted pipelines in the result.
  optional bool show_deleted = 5 [(google.api.field_behavior) = OPTIONAL];
}

// ListPipelinesAdminResponse contains a list of pipelines requested by an
// admin user.
// For the moment, the pipeline recipes will be UID-based (permalink) instead
// of name-based. This is a temporary solution.
message ListPipelinesAdminResponse {
  // A list of pipeline resources.
  repeated Pipeline pipelines = 1;
  // Next page token.
  string next_page_token = 2;
  // Total number of pipelines.
  int32 total_size = 3;
}

// ListPipelinesReleaseAdminRequest represents a request by an admin to list
// all pipeline releases. Admin users have access to pipelines from any user.
message ListPipelineReleasesAdminRequest {
  // The maximum number of releases to return. If this parameter is
  // unspecified, at most 10 releases will be returned. The cap value for this
  // parameter is 100 (i.e. any value above that will be coerced to 100).
  optional int32 page_size = 1 [(google.api.field_behavior) = OPTIONAL];
  // Page token.
  optional string page_token = 2 [(google.api.field_behavior) = OPTIONAL];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 3 [(google.api.field_behavior) = OPTIONAL];
  // Filter can hold an [AIP-160](https://google.aip.dev/160)-compliant filter
  // expression.
  // - Example: `create_time>timestamp("2000-06-19T23:31:08.657Z")`.
  optional string filter = 4 [(google.api.field_behavior) = OPTIONAL];
  // Include soft-deleted pipelines in the result.
  optional bool show_deleted = 5 [(google.api.field_behavior) = OPTIONAL];
}

// ListPipelineReleasesAdminResponse contains a list of pipeline releases
// requested by an admin user.
// For the moment, the pipeline recipes will be UID-based (permalink) instead
// of name-based. This is a temporary solution.
message ListPipelineReleasesAdminResponse {
  // A list of pipeline releases.
  repeated PipelineRelease releases = 1;
  // Next page token.
  string next_page_token = 2;
  // Total number of pipeline releases.
  int32 total_size = 3;
}

// LookUpPipelineAdminRequest represents a request by an admin to query a
// pipeline by its UID.
message LookUpPipelineAdminRequest {
  // The permalink of the pipeline, which allows its access by UID.
  // - Format: `pipelines/{pipeline.uid}`.
  string permalink = 1 [
    (google.api.field_behavior) = REQUIRED,
    (google.api.resource_reference) = {type: "api.instill.tech/Pipeline"},
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {
      field_configuration: {path_param_name: "pipeline_permalink"}
    }
  ];
  // View allows clients to specify the desired pipeline view in the response.
  optional Pipeline.View view = 2 [(google.api.field_behavior) = OPTIONAL];
}

// LookUpPipelineAdminResponse contains the requested pipeline.
message LookUpPipelineAdminResponse {
  // The requested pipeline.
  Pipeline pipeline = 1;
}
